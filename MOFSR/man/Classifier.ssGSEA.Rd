% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Classifier.ssGSEA.R
\name{Classifier.ssGSEA}
\alias{Classifier.ssGSEA}
\title{Perform ssGSEA-based Subtyping Using Marker Gene Sets}
\usage{
Classifier.ssGSEA(
  data.test,
  marker.list,
  dir.file = ".",
  gct.filename = "data.gct",
  number.perms = 10,
  tolerate.mixed = FALSE
)
}
\arguments{
\item{data.test}{A matrix or data frame representing the input expression data, where rows are genes and columns are samples.}

\item{marker.list}{A named list of marker gene sets, where each list element corresponds to a specific subtype or category of interest.}

\item{dir.file}{Character. Directory for saving the output files (default: '.').}

\item{gct.filename}{Character. The filename for the generated GCT file (default: 'data.gct').}

\item{number.perms}{Integer. Number of permutations for ssGSEA analysis (default: 10).}

\item{tolerate.mixed}{Logical. Whether to allow "Mixed" predictions when multiple gene sets have the same minimum p-value (default: FALSE).}
}
\value{
A data frame with the following columns:
  - `ID`: Sample identifiers.
  - `Predict`: Predicted subtype for each sample.
  - Columns with `_pval`: P-values for each marker gene set or subtype.
}
\description{
This function performs single-sample Gene Set Enrichment Analysis (ssGSEA) to assign subtypes to samples based on marker gene sets. It generates necessary input files, runs ssGSEA with permutation testing, and predicts sample subtypes based on the marker enrichment results.
}
\details{
The function:
  1. Uses the provided marker gene sets to create MOD files for ssGSEA analysis.
  2. Generates a GCT file based on the input expression data.
  3. Runs ssGSEA with permutation testing to calculate enrichment scores for each marker gene set in every sample.
  4. Predicts subtypes for samples by identifying the marker gene set with the most significant enrichment (smallest p-value).
  5. If `tolerate.mixed` is TRUE and multiple gene sets share the same minimum p-value, the sample is labeled as "Mixed".
}
\examples{
# Simulated expression data
data.test <- matrix(rnorm(10000), nrow = 100, ncol = 100)
rownames(data.test) <- paste0("Gene", 1:100)
colnames(data.test) <- paste0("Sample", 1:100)

# Example marker list
marker.list <- list(
  Subtype1 = c("Gene1", "Gene2", "Gene3"),
  Subtype2 = c("Gene4", "Gene5", "Gene6")
)

# Run ssGSEA-based subtyping
result <- Classification.ssGSEA(
  data.test = data.test,
  marker.list = marker.list,
  dir.file = "./results",
  gct.filename = "test_data.gct",
  number.perms = 10,
  tolerate.mixed = TRUE
)
print(result)
}
\references{
Wang Q, Hu B, Hu X, Kim H, Squatrito M, Scarpace L, et al. Tumor Evolution of Glioma-Intrinsic Gene Expression Subtypes Associates with Immunological Changes in the Microenvironment. Cancer Cell. July 2017;32(1):42-56.e6.
}
\author{
Zaoqu Liu; Email: liuzaoqu@163.com
}
